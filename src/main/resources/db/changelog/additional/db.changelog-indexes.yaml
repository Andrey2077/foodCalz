databaseChangeLog:
  - changeSet:
      id: enable-pgtrgm
      author: Andrey2077
      preConditions:
        - onFail: MARK_RAN
        - sqlCheck:
            expectedResult: 0
            sql: "SELECT COUNT(*) FROM pg_extension WHERE extname = 'pg_trgm'"
      changes:
        - sql:
            splitStatements: false
            sql: "CREATE EXTENSION IF NOT EXISTS pg_trgm;"

  - changeSet:
      id: create-btree-index-on-diary-entry
      author: Andrey2077
      changes:
        - createIndex:
            indexName: idx_diary_entry_user_date
            tableName: diary_entries
            columns:
              - column:
                  name: user_id
              - column:
                  name: date